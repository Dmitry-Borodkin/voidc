{   v_import("voidc_target.void");
    v_import("voidc_types.void");
    v_import("voidc_util.void");

    v_import("llvm-c/Core.void");

    v_import("expression.void");

    v_import("function.void");
}

{   voidc_enable_expression();
    voidc_enable_function();
}


//=====================================================================
//{   v_add_type("double", v_f64_type());
//}


//---------------------------------------------------------------------
{   module = LLVMModuleCreateWithName("fun_import_test_module");

    v_set_module(module);

    //-----------------------------------------------------------------
    LLVMDisposeMemoryBuffer(voidc_get_unit_buffer());
    voidc_set_unit_buffer(0);
}


//=====================================================================
export
double = float(64);         //- Sic!

export
sin: (double) -> double;

export
sprintf: (str: *char, format: *const char, ...) -> int;

round: (double) -> double;


//---------------------------------------------------------------------
{   v_set_export_flag(true); }


qwerty: (i:int, j:&int) -> void
{
    j := (round(1000000*sin(i)) : int);
}


foo: (bar: *((int, &int) -> void), i: int, j: &int) -> void
{
    bar(i, j);
}


//---------------------------------------------------------------------
c0 = 777;

c1 = -1;

c2: long = -999;

c3 = 'Ð«';


//---------------------------------------------------------------------
Bool = uint(1);

False: Bool = 0;
True:  Bool = 1;


//---------------------------------------------------------------------
v0: &int := 333;

a0: & vec(int, 2) := 7;

s0: & *char := "Qwerty";


//---------------------------------------------------------------------
{   v_set_export_flag(false); }


//=====================================================================
{
    module = v_get_module();

    //-----------------------------------------------------------------
//  v_debug_print_module(1);

    voidc_unit_load_module_to_jit(module);

    LLVMDisposeModule(module);
    v_set_module(0);
}


